@import models.AuthenticatedRequest
@import views.html.components.{Block}
@import uk.gov.hmrc.hmrcfrontend.config.AssetsConfig

@this(
    block: Block, 
    assetConfig: AssetsConfig,
    govukServiceNavigation: GovukServiceNavigation,
    govukSelect: GovukSelect
)

@(dbId: Int, personOption: Option[Person])(contentBlock: Html)(implicit request: AuthenticatedRequest[?], messages: Messages)

@loginOrlogout = @{
    if(request.localSession.sessionData.userData.isEmpty) {
        Some(ServiceNavigationItem(
            content = Text("Login"),
            href = s"${controllers.routes.LoginController.onLoad().url}?returnUrl=request.request.uri",
            active = false,
            current = false,
            classes = "",
            attributes = Map.empty
        ))
    } else {
        Some(ServiceNavigationItem(
            content = Text("Logout"),
            href = controllers.routes.LogoutController.onLoad().url,
            active = false,
            current = false,
            classes = "",
            attributes = Map.empty
        ))
    }
}

@lastSeen = @{
    """<div class="govuk-service-navigation__item govuk-!-padding-top-2">
        <form action="#">
        Last seen: <select class="govuk-select" id="sort" name="sort">""" +
        request.localSession.sessionData.history.map { el => 
            s"""<option value="${el.personId}">${el.name}</option>""""
        }.mkString("") +
    """</select>
        <input type="submit" value="Go" />
    </form></div>"""
}

<html lang="fr" >
<head>
    <title>Genealogie</title>
    <meta name="Description" content="" />
    <meta name="Keywords" content="genealogie, genealogy" />
    <meta name="Author" content="Pascal Parois" />
    <meta http-equiv="Content-language" content="fr" />
    <meta charset="UTF-8" />

    <link rel="stylesheet" media="screen" href="@routes.Assets.versioned("stylesheets/main.css")">
    <link rel="stylesheet" media="screen" href="@assetConfig.hmrcFrontendCssUrl">
    <script src="@assetConfig.hmrcFrontendJsUrl" type="text/javascript"></script>

</head>
<body>
    <header>
        <div class="govuk-grid-row box_title govuk-!-margin-left-2 govuk-!-margin-right-2 govuk-!-margin-bottom-0">
            <div class="govuk-grid-column-full">
                <div class="govuk-header__logo">&nbsp;</div>
                <div class="govuk-header__content">
                    <h1 class="govuk-heading-xl govuk-!-margin-4">My genealogy tree</h1>
                </div>
            </div>
        </div>

        <div class="govuk-grid-row box_title govuk-!-margin-left-2 govuk-!-margin-right-2 govuk-!-margin-top-0">
            <div class="govuk-grid-column-full">
        @govukServiceNavigation(ServiceNavigation(
            serviceName = None,
            serviceUrl = None,
            navigation = Seq(
                Some(ServiceNavigationItem(
                    content = Text("Home"),
                    href = "/",
                    active = false,
                    current = false,
                    classes = "",
                    attributes = Map.empty
                )),
                Some(ServiceNavigationItem(
                    content = Text("Surnames"),
                    href = controllers.routes.HomeController.showSurnames(dbId).url,
                    active = false,
                    current = false,
                    classes = "",
                    attributes = Map.empty
                )),
                personOption.map { person =>
                    ServiceNavigationItem(
                        content = Text("Person details"),
                        href = controllers.routes.IndividualController.showPerson(person.details.id).url,
                        active = false,
                        current = false,
                        classes = "",
                        attributes = Map.empty
                    )
                },
                loginOrlogout
            ).flatten,
            navigationClasses = "",
            navigationId = "navigation",
            navigationLabel = Some("navigationLabel"),
            classes = "",
            attributes = Map.empty,
            ariaLabel = None,
            menuButtonText = Some("menuButtonText"),
            menuButtonLabel = Some("menuButtonLabel"),
            slots = Some(ServiceNavigationSlot(
                start = None,
                end =  None,
                navigationStart = None,
                navigationEnd = None
              ))
        ))
        </div>
        </div>

    </header>

    <div class="govuk-width-container">
        <main class="govuk-main-wrapper">
         <div class="govuk-grid-row">
            <div class="govuk-grid-column-full box" id="main-content">
                    @contentBlock
            </div>
        </div>
    </main>
</div>

<footer>
    <div class="govuk-grid-row box_title govuk-!-margin-2">
        <div class="govuk-grid-column-full">
            <a href="mailto:genealogie@("@")parois.net">genealogie.parois.net </a>
        </div>
    </div>
</footer>
    
</body></html>